# Task Plan - Blog CMS

## 项目信息

- **项目名称**: Blog CMS
- **技术栈**: Next.js 14 + TypeScript + SQLite + Drizzle ORM + Tailwind CSS
- **模式**: 团队模式 (Commander + Worker)
- **创建时间**: 2026-01-28

---

## Phase 1: 项目初始化 (P1)

### 1.1 创建 Next.js 项目
- **类型**: setup
- **FR**: -
- **描述**: 使用 create-next-app 初始化项目
- **验收标准**:
  - [ ] 项目创建成功
  - [ ] TypeScript 配置正确
  - [ ] 可以运行 `npm run dev`

### 1.2 安装依赖
- **类型**: setup
- **FR**: -
- **描述**: 安装项目所需依赖
- **依赖列表**:
  - drizzle-orm, better-sqlite3
  - @types/better-sqlite3
  - drizzle-kit (dev)
  - tailwindcss, postcss, autoprefixer
  - react-markdown, remark-gfm
  - react-syntax-highlighter, @types/react-syntax-highlighter
  - lucide-react (图标)
- **验收标准**:
  - [ ] 所有依赖安装成功
  - [ ] package.json 更新正确

### 1.3 配置 Tailwind CSS
- **类型**: setup
- **FR**: -
- **描述**: 配置 Tailwind CSS
- **验收标准**:
  - [ ] tailwind.config.js 配置正确
  - [ ] globals.css 包含 Tailwind 指令
  - [ ] 样式生效

### 1.4 配置数据库
- **类型**: setup
- **FR**: -
- **描述**: 配置 Drizzle ORM + SQLite
- **验收标准**:
  - [ ] drizzle.config.ts 创建
  - [ ] 数据库连接测试通过
  - [ ] db/index.ts 导出数据库实例

---

## Phase 2: 数据模型 (P1)

### 2.1 定义 Schema
- **类型**: code
- **FR**: FR-001, FR-003, FR-004
- **描述**: 创建数据库 Schema (categories, posts 表)
- **验收标准**:
  - [ ] db/schema.ts 创建
  - [ ] 类型定义正确
  - [ ] 外键关系定义

### 2.2 运行迁移
- **类型**: setup
- **FR**: -
- **描述**: 生成并运行数据库迁移
- **验收标准**:
  - [ ] 迁移文件生成
  - [ ] 数据库表创建成功
  - [ ] 可以插入测试数据

### 2.3 创建种子数据
- **类型**: code
- **FR**: -
- **描述**: 创建测试用种子数据
- **验收标准**:
  - [ ] db/seed.ts 创建
  - [ ] 至少 3 个分类
  - [ ] 至少 5 篇测试文章

---

## Phase 3: API 路由 (P1)

### 3.1 文章 API
- **类型**: code
- **FR**: FR-001, FR-004
- **描述**: 实现文章 CRUD API
- **端点**:
  - GET /api/posts
  - GET /api/posts/[slug]
  - POST /api/posts
  - PUT /api/posts/[id]
  - DELETE /api/posts/[id]
- **验收标准**:
  - [ ] 所有端点实现
  - [ ] 分页参数支持
  - [ ] 错误处理完善

### 3.2 分类 API
- **类型**: code
- **FR**: FR-003
- **描述**: 实现分类 CRUD API
- **验收标准**:
  - [ ] 所有端点实现
  - [ ] 删除检查关联文章
  - [ ] 错误处理完善

### 3.3 搜索 API
- **类型**: code
- **FR**: FR-002
- **描述**: 实现搜索功能
- **验收标准**:
  - [ ] 标题/内容搜索
  - [ ] 结果分页

---

## Phase 4: 前台页面 (P1)

### 4.1 布局组件
- **类型**: code
- **FR**: FR-001
- **描述**: 创建公共布局组件 (Header, Footer, Layout)
- **验收标准**:
  - [ ] 响应式设计
  - [ ] 导航链接正确

### 4.2 首页 (文章列表)
- **类型**: code
- **FR**: FR-001
- **描述**: 实现首页文章列表
- **验收标准**:
  - [ ] 文章列表渲染
  - [ ] 分页功能
  - [ ] 点击跳转详情

### 4.3 文章详情页
- **类型**: code
- **FR**: FR-001
- **描述**: Markdown 渲染、代码高亮
- **验收标准**:
  - [ ] Markdown 正确渲染
  - [ ] 代码语法高亮
  - [ ] SEO meta tags

### 4.4 分类页面
- **类型**: code
- **FR**: FR-003
- **描述**: 实现分类文章列表页
- **验收标准**:
  - [ ] 按分类筛选
  - [ ] 分页正常

### 4.5 搜索页面
- **类型**: code
- **FR**: FR-002
- **描述**: 实现搜索结果页
- **验收标准**:
  - [ ] 搜索框功能
  - [ ] 结果展示
  - [ ] 关键词高亮

---

## Phase 5: 管理后台 (P1)

### 5.1 后台布局
- **类型**: code
- **FR**: FR-005
- **描述**: 创建管理后台布局 (AdminLayout, Sidebar)
- **验收标准**:
  - [ ] 侧边栏导航
  - [ ] 响应式设计

### 5.2 文章管理列表
- **类型**: code
- **FR**: FR-004, FR-005
- **描述**: 文章表格展示、状态筛选、操作按钮
- **验收标准**:
  - [ ] 表格分页
  - [ ] 状态筛选
  - [ ] 编辑/删除操作

### 5.3 文章编辑器
- **类型**: code
- **FR**: FR-004
- **描述**: Markdown 编辑器、实时预览、自动保存
- **验收标准**:
  - [ ] 编辑区和预览区
  - [ ] 分类/状态选择
  - [ ] 自动保存 (30s)

### 5.4 分类管理
- **类型**: code
- **FR**: FR-003, FR-005
- **描述**: 分类 CRUD 管理页
- **验收标准**:
  - [ ] CRUD 功能完整
  - [ ] 删除确认提示

### 5.5 仪表盘
- **类型**: code
- **FR**: FR-005
- **描述**: 统计数据展示
- **验收标准**:
  - [ ] 文章/分类总数
  - [ ] 最近文章列表

---

## Phase 6: 测试与优化 (P2)

### 6.1 功能测试
- **类型**: test
- **FR**: ALL
- **描述**: 全面功能测试
- **验收标准**:
  - [ ] 所有页面可访问
  - [ ] CRUD 操作正常
  - [ ] 响应式布局正常

### 6.2 性能优化
- **类型**: optimize
- **FR**: NFR-001
- **描述**: 首页加载 < 2s
- **验收标准**:
  - [ ] 加载时间达标
  - [ ] 数据库查询优化

### 6.3 SEO 优化
- **类型**: optimize
- **FR**: FR-001
- **描述**: SEO meta tags 完善
- **验收标准**:
  - [ ] 页面 title 正确
  - [ ] Open Graph tags

---

## 验收标准汇总

| Phase | 关键验收点 |
|-------|-----------|
| 1 | `npm run dev` 启动成功 |
| 2 | 数据库表创建成功，种子数据可查询 |
| 3 | API 端点 curl 测试通过 |
| 4 | 首页、详情页、搜索页正常访问 |
| 5 | 后台 CRUD 操作正常 |
| 6 | 全功能测试通过 |

---

*计划版本: 1.0.0*
*创建时间: 2026-01-28*
